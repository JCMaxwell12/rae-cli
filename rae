#!/bin/bash
#0.14

#verificar si el directorio ./rae existe
[[ ! -d .rae/ ]] && mkdir .rae/

# Conjugaciones #
if [ "$1" = "-c" ]; then
in="$2"
fu="fetch?w"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${fu}${in} > .rae/.pa.txt

sed -n '/ConjugaciÃ³n de/,$p' .rae/.pa.txt > .rae/.pb.txt
sed '/Todos los derechos reservados/q0' .rae/.pb.txt > .rae/.pc.txt
cat .rae/.pc.txt
p=`awk 'NR==1 {print; exit}' .rae/.pc.txt`
p2=`cat .rae/.pc.txt`

# Palabras segun primeras letras #
else if [ "$1" = "-e" ]; then
in="$2"
fu="?m=31"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${in}${fu} > .rae/.contiene.txt
sed -e '1,/ConsultarÂ ]/ d' .rae/.contiene.txt > .rae/.pa.txt
sed '/Todos los derechos reservados/q0' .rae/.pa.txt

# Palabras segun ultimas letras #
else if [ "$1" = "-t" ]; then
in="$2"
fu="?m=32"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${in}${fu} > .rae/.contiene.txt
sed -e '1,/ConsultarÂ ]/ d' .rae/.contiene.txt > .rae/.pa.txt
sed '/Todos los derechos reservados/q0' .rae/.pa.txt

# Palabras segun ultimas letras #
else if [ "$1" = "-C" ]; then
in="$2"
fu="?m=33"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${in}${fu} > .rae/.contiene.txt

sed -e '1,/ConsultarÂ ]/ d' .rae/.contiene.txt > .rae/.pa.txt
sed '/Todos los derechos reservados/q0' .rae/.pa.txt

# Ayuda #
else if [ "$1" = "--ayuda" ]; then
cat <<-ayuda

RAE-CLI 0.12, el Diccionario de la Real Academia EspaÃ±ola desde la terminal.

Ejemplos: rae azul
          rae -C ada

Posibles usos en la versiÃ³n 0.10:
        rae [PALABRA], muestra la primera definiciÃ³n de la palabra.
        rae -td [PALABRA], muestra todas las definiciones de la palabra e informaciÃ³n adicional.
        rae -p, muestra la palabra del dia.
        rae -A, muestra la definicion de una palabra aleatoriamente.
        rae -a [PALABRA], muestra anagramas de la palabra.
        rae -C [LETRAS], muestra palabras que contengan las letras introducidas.
        rae -e [LETRAS], muestra palabras que empiecen con las letras introducidas.
        rae -t [LETRAS], muestra palabras que terminen con las letras introducidas.
        rae -c [PALABRA], muestra las posibles conjugaciones de la palabra.

        rae  --ayuda, muestra esta pantalla.

Todas las definiciones son propiedad de la Real Academia EspaÃ±ola.

EnvÃ­e informaciÃ³n sobre errores y sugerencias a <sardach@uwu.mx>.

ayuda

# Sin Argumentos #
else if [ "$1" = "" ]; then
cat <<-noarg

Se requieren argumentos para usar este script.

Intenta Â«rae --ayudaÂ» para mas informaciÃ³n

noarg

# Anagramas #
else if [ "$1" = "-a" ]; then
in="$2"
fu="?m=anagram"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${in}${fu} > .rae/.anagrama.txt

sed -e '1,/ConsultarÂ ]/ d' .rae/.anagrama.txt > .rae/.pa.txt
sed '/Todos los derechos reservados/q0' .rae/.pa.txt

# Aleatorio #
else if [ "$1" = "-A" ]; then
elinks -no-numbering -no-references -dump "https://dle.rae.es/?m=random" > .rae/.random.txt

sed -e '1,/ConsultarÂ ]/ d' .rae/.random.txt > .rae/.pa.txt
sed '/ConjugaciÃ³n de/,$d' .rae/.pa.txt > .rae/.pb.txt ##bora las conjugaciones si estan presentes
sed '/Todos los derechos reservados/q0' .rae/.pb.txt

# Palabra del Dia #
else if [ "$1" = "-p" ]; then
elinks -no-numbering -no-references -dump "https://dle.rae.es/?=wotd" > .rae/.wotd2.txt

sed -e '1,/ConsultarÂ ]/ d' .rae/.wotd2.txt > .rae/.pa.txt
sed '/Todos los derechos reservados/q0' .rae/.pa.txt > .rae/.pb.txt
wotd=`sed 's/<[^>]\+>//g' .rae/.pb.txt`
cat <<-pdd

Palabra del dia:$wotd

pdd
# Todas las Definiciones #
else if [ "$1" = "-td" ]; then
in="$2"
fu="fetch?w"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${in} > .rae/.pa.txt
sed -e '1,/ConsultarÂ ]/ d' .rae/.pa.txt > .rae/.pb.txt
sed '/ConjugaciÃ³n de/,$d' .rae/.pb.txt > .rae/.pc.txt ##bora las conjugaciones si estan presentes
sed '/Todos los derechos reservados/q0' .rae/.pc.txt > .rae/.pd.txt
cat .rae/.pd.txt



# Una sola definiciÃ³n #
else if [ "$1" != "" ]; then
in="$1"
elinks -no-numbering -no-references -dump "https://dle.rae.es/"${in} > .rae/.pa.txt
sed -e '1,/ConsultarÂ ]/ d' .rae/.pa.txt > .rae/.pb.txt
sed '/2./,$d' .rae/.pb.txt > .rae/.pc.txt
sed '/Todos los derechos reservados/q0' .rae/.pc.txt > .rae/.pd.txt
echo "
             Real Academia EspaÃ±ola Â© Todos los derechos reservados
">> .rae/.pd.txt
cat .rae/.pd.txt
p=`awk 'NR==1 {print; exit}' .rae/.pc.txt`
p2=`cat .rae/.pc.txt`
if [ "$p" = "$p2" ]; then
cat <<-nores

	No se encontraron resultados, la palabra puede no estar registrada o haber sido introducida
	sin la ortografia correcta.

nores


fi fi fi fi fi fi fi fi fi fi fi fi 
